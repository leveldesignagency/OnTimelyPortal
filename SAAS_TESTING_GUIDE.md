# Timely Mobile App - SaaS Testing Guide

## 🎯 Overview

This guide explains how to test the **SaaS-ready** Timely mobile app with proper guest login functionality. **No hardcoded users** - everything is generated dynamically by companies using the desktop app.

## 🗄️ Database Setup

### 1. Run the Guest Login Table Setup

In your Supabase SQL Editor, run the script:
```sql
-- Copy and paste the contents of create_guest_logins_table.sql
```

This creates:
- ✅ `guest_logins` table for temporary mobile credentials
- ✅ Database functions for SaaS operations:
  - `create_guest_login(guest_id, event_id, email)` - Creates guest credentials
  - `validate_guest_login(email, password)` - Validates mobile login
  - `mark_guest_login_accessed(email, password)` - Tracks usage
  - `cleanup_expired_guest_logins()` - Auto-cleanup after 7 days

### 2. Verify Setup
```sql
-- Check if functions exist
SELECT routine_name FROM information_schema.routines 
WHERE routine_name LIKE '%guest_login%';

-- Should show:
-- create_guest_login
-- validate_guest_login  
-- mark_guest_login_accessed
-- cleanup_expired_guest_logins
```

## 🖥️ Desktop App - Generate Guest Logins

### 1. Create an Event
1. Open the Timely Desktop app
2. Create a new event with guests
3. Navigate to "Event Portal Management"

### 2. Generate Guest Credentials
1. Click "Generate Guest Logins" 
2. The system will:
   - ✅ Call `create_guest_login()` for each guest
   - ✅ Generate secure 8-character passwords
   - ✅ Create mobile login URLs
   - ✅ Set 7-day expiration
   - ✅ Save to database (not just local state)

### 3. Copy Guest Credentials
- Each guest gets unique credentials
- Password format: 8 characters (e.g., "A7K9M2N4")
- Expiry: 7 days from generation

## 📱 Mobile App Testing

### 1. Start the Mobile App
```bash
cd timely-mobile
npm start
```

### 2. Test Guest Login
1. Select "Guest Login" tab
2. Enter credentials generated by desktop app:
   - **Email**: Guest's email from the event
   - **Password**: 8-character code from desktop app

### 3. Expected Results
- ✅ **Success**: Timeline screen with event details
- ❌ **Invalid credentials**: "Invalid login credentials"  
- ❌ **Expired**: "Login credentials have expired"

### 4. Test Admin Login
1. Select "Admin Login" tab
2. Use your company's admin credentials
3. Should see company events timeline

## 🔧 Key Features Working

### ✅ **SaaS-Ready Architecture**
- No hardcoded users
- Companies generate their own guest credentials
- Multi-tenant isolation by company

### ✅ **Security Features**
- Passwords auto-generated (not predictable)
- 7-day expiration on guest logins
- Automatic cleanup of expired credentials
- Login tracking (pending → accessed)

### ✅ **Mobile App Features**
- Dual login system (Admin/Guest)
- Session-only authentication (no persistence)
- Timeline view for authenticated users
- Proper error handling

## 🐛 Troubleshooting

### "Invalid login credentials"
1. **Check desktop app**: Verify guest login was generated
2. **Check database**: 
   ```sql
   SELECT * FROM guest_logins WHERE email = 'guest@example.com';
   ```
3. **Check expiry**: Ensure `expires_at > NOW()`

### "Guest login system setup complete!"
- ✅ Database functions created successfully
- Ready for testing

### Mobile app won't start
1. **Remove old dependencies**:
   ```bash
   cd timely-mobile
   rm -rf node_modules package-lock.json
   npm install
   ```

### Desktop app errors
1. **Check Supabase connection**
2. **Verify guest_logins table exists**
3. **Check browser console for RPC errors**

## 🎉 Success Criteria

### ✅ **Desktop App**
- Generate guest logins without errors
- Real passwords saved to database
- Copy/send functionality works

### ✅ **Mobile App**  
- Guest login accepts generated credentials
- Shows timeline for authenticated guests
- Admin login works for company users
- No AsyncStorage errors

### ✅ **Database**
- Guest logins stored with proper expiry
- Functions execute without errors
- Cleanup removes old credentials

## 📞 Testing Workflow

1. **Company Admin** uses desktop app to create event
2. **Company Admin** generates guest logins via "Event Portal Management"
3. **Company Admin** shares credentials with guests
4. **Guests** use mobile app with provided credentials
5. **Guests** see their event timeline
6. **System** automatically cleans up expired logins

This is a **true SaaS system** - each company manages their own guests and credentials! 
 

## 🎯 Overview

This guide explains how to test the **SaaS-ready** Timely mobile app with proper guest login functionality. **No hardcoded users** - everything is generated dynamically by companies using the desktop app.

## 🗄️ Database Setup

### 1. Run the Guest Login Table Setup

In your Supabase SQL Editor, run the script:
```sql
-- Copy and paste the contents of create_guest_logins_table.sql
```

This creates:
- ✅ `guest_logins` table for temporary mobile credentials
- ✅ Database functions for SaaS operations:
  - `create_guest_login(guest_id, event_id, email)` - Creates guest credentials
  - `validate_guest_login(email, password)` - Validates mobile login
  - `mark_guest_login_accessed(email, password)` - Tracks usage
  - `cleanup_expired_guest_logins()` - Auto-cleanup after 7 days

### 2. Verify Setup
```sql
-- Check if functions exist
SELECT routine_name FROM information_schema.routines 
WHERE routine_name LIKE '%guest_login%';

-- Should show:
-- create_guest_login
-- validate_guest_login  
-- mark_guest_login_accessed
-- cleanup_expired_guest_logins
```

## 🖥️ Desktop App - Generate Guest Logins

### 1. Create an Event
1. Open the Timely Desktop app
2. Create a new event with guests
3. Navigate to "Event Portal Management"

### 2. Generate Guest Credentials
1. Click "Generate Guest Logins" 
2. The system will:
   - ✅ Call `create_guest_login()` for each guest
   - ✅ Generate secure 8-character passwords
   - ✅ Create mobile login URLs
   - ✅ Set 7-day expiration
   - ✅ Save to database (not just local state)

### 3. Copy Guest Credentials
- Each guest gets unique credentials
- Password format: 8 characters (e.g., "A7K9M2N4")
- Expiry: 7 days from generation

## 📱 Mobile App Testing

### 1. Start the Mobile App
```bash
cd timely-mobile
npm start
```

### 2. Test Guest Login
1. Select "Guest Login" tab
2. Enter credentials generated by desktop app:
   - **Email**: Guest's email from the event
   - **Password**: 8-character code from desktop app

### 3. Expected Results
- ✅ **Success**: Timeline screen with event details
- ❌ **Invalid credentials**: "Invalid login credentials"  
- ❌ **Expired**: "Login credentials have expired"

### 4. Test Admin Login
1. Select "Admin Login" tab
2. Use your company's admin credentials
3. Should see company events timeline

## 🔧 Key Features Working

### ✅ **SaaS-Ready Architecture**
- No hardcoded users
- Companies generate their own guest credentials
- Multi-tenant isolation by company

### ✅ **Security Features**
- Passwords auto-generated (not predictable)
- 7-day expiration on guest logins
- Automatic cleanup of expired credentials
- Login tracking (pending → accessed)

### ✅ **Mobile App Features**
- Dual login system (Admin/Guest)
- Session-only authentication (no persistence)
- Timeline view for authenticated users
- Proper error handling

## 🐛 Troubleshooting

### "Invalid login credentials"
1. **Check desktop app**: Verify guest login was generated
2. **Check database**: 
   ```sql
   SELECT * FROM guest_logins WHERE email = 'guest@example.com';
   ```
3. **Check expiry**: Ensure `expires_at > NOW()`

### "Guest login system setup complete!"
- ✅ Database functions created successfully
- Ready for testing

### Mobile app won't start
1. **Remove old dependencies**:
   ```bash
   cd timely-mobile
   rm -rf node_modules package-lock.json
   npm install
   ```

### Desktop app errors
1. **Check Supabase connection**
2. **Verify guest_logins table exists**
3. **Check browser console for RPC errors**

## 🎉 Success Criteria

### ✅ **Desktop App**
- Generate guest logins without errors
- Real passwords saved to database
- Copy/send functionality works

### ✅ **Mobile App**  
- Guest login accepts generated credentials
- Shows timeline for authenticated guests
- Admin login works for company users
- No AsyncStorage errors

### ✅ **Database**
- Guest logins stored with proper expiry
- Functions execute without errors
- Cleanup removes old credentials

## 📞 Testing Workflow

1. **Company Admin** uses desktop app to create event
2. **Company Admin** generates guest logins via "Event Portal Management"
3. **Company Admin** shares credentials with guests
4. **Guests** use mobile app with provided credentials
5. **Guests** see their event timeline
6. **System** automatically cleans up expired logins

This is a **true SaaS system** - each company manages their own guests and credentials! 
 